<?xml version="1.0" encoding="utf-8"?>
<mx:Image xmlns:mx="http://www.adobe.com/2006/mxml" width="32" height="32" 
						source="{utils.Utils.trash_icon}"
						dragEnter="DragEnter(event)"
						dragOver="DragOver(event)"
						dragExit="DragExit(event)"
						dragDrop="DragDrop(event)">
	<mx:Script>
		<![CDATA[
			import mx.controls.Tree;
			import mx.events.DragEvent;
			import utils.*;
			import mx.core.DragSource;
			import mx.managers.DragManager;
			import mx.core.UIComponent;
			
			public var confirm:String;
			public var callBack:Function;
			public var src:Object;
			public var srcClass:Class;
			public var excludeTags:Array;
			public var onlyTags:Array;
			
			public var dragEnterOverride:Boolean = false;
			
			protected function DragOver(event:DragEvent):void {
            	utils.Utils.trashGrow(this, true);
            	DragManager.showFeedback(DragManager.LINK);
            	glow.play();	 	
            }   
            
            protected function DragExit(event:DragEvent):void {
            	utils.Utils.trashGrow(this, false);	 	
            	glowOut.play();
            } 
            
            protected function DragDrop(event:DragEvent):void {
            	DragExit(event);
            	Alert.show(confirm, Str.xml.remove_confirm.@string, mx.controls.Alert.YES|mx.controls.Alert.NO, this, callBack, null, mx.controls.Alert.NO);
            }
            
            private function DragEnter(event:DragEvent):void {
            	if(this.dragEnterOverride) return;
				if((src && event.dragInitiator == src) || (srcClass && event.dragInitiator is srcClass)) {
					if(excludeTags && excludeTags.indexOf((Tree(src).selectedItem as XML).localName().toString()) >= 0) {
						return;
					}
					if(onlyTags && onlyTags.indexOf((Tree(src).selectedItem as XML).localName().toString()) < 0) {
						return;
					}
					if(srcClass) src = event.dragInitiator;
					DragManager.acceptDragDrop(UIComponent(event.currentTarget));
					glow.play();
				}
			}			
		]]>
	</mx:Script>
	<mx:Glow id="glow" duration="1000" 
        alphaFrom="1.0" alphaTo="0" 
        blurXFrom="0.0" blurXTo="50.0" 
        blurYFrom="0.0" blurYTo="50.0" 
        color="0x00FF80" target="{this}" repeatCount="10000"/>
    <mx:Glow id="glowOut" duration="1000" 
        alphaFrom="0.5" alphaTo="0" 
        blurXFrom="0.0" blurXTo="50.0" 
        blurYFrom="0.0" blurYTo="50.0" 
        color="0x00FF80" effectStart="glow.stop()" target="{this}"/>    
</mx:Image>
